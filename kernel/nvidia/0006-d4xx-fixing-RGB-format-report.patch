From 7fbb9b73c8ffc91a9da8d066664e948bff3b7153 Mon Sep 17 00:00:00 2001
From: Alex Gantman <alexander.gantman@intel.com>
Date: Tue, 10 Dec 2019 14:19:31 +0200
Subject: [PATCH] d4xx: fixing RGB format report

Signed-off-by: Alex Gantman <alexander.gantman@intel.com>
---
 drivers/media/i2c/d4xx.c | 10 +++++++++-
 1 file changed, 9 insertions(+), 1 deletion(-)

diff --git a/drivers/media/i2c/d4xx.c b/drivers/media/i2c/d4xx.c
index 24b9a65..0773c8e 100644
--- a/drivers/media/i2c/d4xx.c
+++ b/drivers/media/i2c/d4xx.c
@@ -2114,6 +2114,12 @@ static int ds5_mux_get_fmt(struct v4l2_subdev *sd, struct v4l2_subdev_pad_config
 
 	dev_info(sd->dev, "%s(): %u %p\n", __func__, pad, state->mux.last_set);
 
+	if (state->is_rgb) {
+		tmp.pad = DS5_MUX_PAD_RGB;
+		pad = DS5_MUX_PAD_RGB;
+	} else
+		tmp.pad = 0;
+
 	switch (pad) {
 	case DS5_MUX_PAD_MOTION_T:
 		remote_sd = &state->motion_t.sensor.sd;
@@ -2124,11 +2130,13 @@ static int ds5_mux_get_fmt(struct v4l2_subdev *sd, struct v4l2_subdev_pad_config
 	case DS5_MUX_PAD_EXTERNAL:
 		remote_sd = &state->mux.last_set->sd;
 		break;
+	case DS5_MUX_PAD_RGB:
+		remote_sd = &state->rgb.sensor.sd;
+		break;
 	default:
 		return -EINVAL;
 	}
 
-	tmp.pad = 0;
 
 	/* Locks internally */
 	ret = ds5_sensor_get_fmt(remote_sd, cfg, &tmp);
-- 
2.7.4

